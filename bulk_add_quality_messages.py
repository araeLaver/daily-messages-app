#!/usr/bin/env python3
import psycopg2
import uuid
from datetime import datetime

DATABASE_CONFIG = {
    'host': 'ep-blue-unit-a2ev3s9x.eu-central-1.pg.koyeb.app',
    'database': 'untab',
    'user': 'untab', 
    'password': '0AbVNOIsl2dn',
    'port': 5432
}

def bulk_add_messages():
    # 카테고리별 고품질 메시지 (Author 정보 포함)
    quality_messages = {
        "동기부여": [
            ("당신의 유일한 한계는 당신의 마음입니다.", "나폴레온 힐"),
            ("성공의 90%는 그냥 나타나는 것입니다.", "우디 앨런"),
            ("꿈을 이루고 싶다면 먼저 깨어나야 합니다.", "마크 트웨인"),
            ("불가능한 것은 시도해보지 않은 것뿐입니다.", "짐 론"),
            ("당신이 믿는 것이 당신의 현실이 됩니다.", "오푸라 윈프리"),
            ("성공은 준비와 기회가 만나는 지점입니다.", "세네카"),
            ("실패는 성공으로 향하는 디딤돌입니다.", "브라이언 트레이시"),
            ("포기하지 않으면 꿈은 반드시 이루어집니다.", "월트 디즈니"),
            ("오늘의 고통이 내일의 힘이 됩니다.", "아놀드 슈워제네거"),
            ("당신의 운명을 스스로 만들어 나가세요.", "랄프 왈도 에머슨"),
        ],
        "긍정": [
            ("긍정적인 마음은 긍정적인 결과를 만듭니다.", "노먼 빈센트 필"),
            ("행복은 습관입니다. 그 습관을 기르세요.", "허버트 사이먼"),
            ("웃음은 마음의 약이자 영혼의 양식입니다.", "그루초 마르크스"),
            ("매일 아침 새로운 희망으로 시작하세요.", "마야 안젤루"),
            ("긍정적인 생각은 긍정적인 삶을 만듭니다.", "루이즈 헤이"),
            ("좋은 일은 좋은 마음에서 시작됩니다.", "달라이 라마"),
            ("오늘은 선물입니다. 그래서 present라고 하죠.", "엘리너 루즈벨트"),
            ("희망은 어둠 속에서 빛나는 별과 같습니다.", "마틴 루터 킹"),
            ("감사하는 마음이 행복의 문을 엽니다.", "멜로디 비티"),
            ("미소는 세상을 밝게 만드는 작은 등불입니다.", "마더 테레사"),
        ],
        "성공": [
            ("성공의 비밀은 시작하는 것입니다.", "마크 트웨인"),
            ("성공은 실패에서 실패로 가면서도 열정을 잃지 않는 것입니다.", "윈스턴 처칠"),
            ("성공한 사람은 실패를 두려워하지 않습니다.", "마이클 조던"),
            ("성공은 1%의 영감과 99%의 땀입니다.", "토머스 에디슨"),
            ("성공의 열쇠는 다른 사람을 돕는 것입니다.", "지그 지글러"),
            ("성공은 목적지가 아니라 여행입니다.", "벤 스위트랜드"),
            ("성공하려면 먼저 실패할 준비를 하세요.", "존 맥스웰"),
            ("성공은 기회를 만날 준비가 된 상태입니다.", "랜디 포시"),
            ("성공의 가장 큰 적은 성공 자체입니다.", "빌 게이츠"),
            ("성공은 꾸준함에서 나옵니다.", "로버트 콜리어"),
        ],
        "행복": [
            ("행복은 여행의 방식이지 목적지가 아닙니다.", "로이 굿먼"),
            ("행복은 선택입니다. 매일 행복을 선택하세요.", "소냐 류보머스키"),
            ("작은 것에서 큰 기쁨을 찾는 것이 행복의 비밀입니다.", "존 러스킨"),
            ("행복은 다른 사람과 나눌 때 더욱 커집니다.", "앨버트 슈바이처"),
            ("행복한 사람은 다른 사람을 행복하게 만듭니다.", "볼테르"),
            ("행복은 완벽함이 아니라 충족감입니다.", "브레네 브라운"),
            ("현재 순간에 집중하면 행복이 찾아옵니다.", "틱낫한"),
            ("행복은 내면에서 나오는 빛입니다.", "헬렌 켈러"),
            ("감사하는 마음이 행복의 시작입니다.", "오푸라 윈프리"),
            ("단순함 속에서 행복을 찾으세요.", "레오 톨스토이"),
        ],
        "건강": [
            ("건강한 몸에 건강한 정신이 깃듭니다.", "유베날리스"),
            ("건강은 최고의 선물이자 만족은 최고의 재산입니다.", "부처"),
            ("운동은 몸을 위한 명상이고 명상은 마음을 위한 운동입니다.", "사라 파워스"),
            ("예방이 치료보다 중요합니다.", "벤자민 프랭클린"),
            ("건강을 잃으면 모든 것을 잃습니다.", "쇼펜하우어"),
            ("충분한 수면은 건강의 기초입니다.", "아리스토텔레스"),
            ("균형 잡힌 식사가 건강한 삶의 시작입니다.", "히포크라테스"),
            ("스트레스 관리는 건강 관리의 핵심입니다.", "한스 셀리에"),
            ("물은 생명의 원천입니다. 충분히 마시세요.", "루이 파스퇴르"),
            ("건강한 습관이 건강한 인생을 만듭니다.", "아리스토텔레스"),
        ],
        "지혜": [
            ("아는 것을 안다 하고 모르는 것을 모른다 하는 것이 참 아는 것이니라.", "공자"),
            ("배움에는 끝이 없습니다.", "소크라테스"),
            ("지혜는 경험의 딸입니다.", "레오나르도 다 빈치"),
            ("질문하는 것이 답을 찾는 시작입니다.", "아인슈타인"),
            ("실수에서 배우는 것이 가장 큰 지혜입니다.", "엘리너 루즈벨트"),
            ("겸손함이 지혜의 시작입니다.", "솔로몬"),
            ("지혜로운 사람은 말보다 행동으로 보여줍니다.", "벤자민 프랭클린"),
            ("과거에서 배우고 현재에 집중하며 미래를 준비하세요.", "처칠"),
            ("진정한 지혜는 자신의 무지를 아는 것입니다.", "소크라테스"),
            ("경험은 최고의 선생님입니다.", "율리우스 카이사르"),
        ],
        "창의성": [
            ("창의성은 연결하는 것입니다.", "스티브 잡스"),
            ("상상력은 지식보다 중요합니다.", "아인슈타인"),
            ("모든 창의적 행위는 파괴 행위입니다.", "파블로 피카소"),
            ("창의성은 용기가 필요합니다.", "앙리 마티스"),
            ("제약이 있을 때 창의성이 꽃핍니다.", "찰스 이메스"),
            ("다르게 생각하세요.", "스티브 잡스"),
            ("창의성은 실패를 두려워하지 않습니다.", "제임스 다이슨"),
            ("새로운 아이디어는 기존 것들의 새로운 조합입니다.", "제임스 웹 영"),
            ("호기심이 창의성의 엔진입니다.", "아인슈타인"),
            ("완벽함을 추구하면 창의성이 죽습니다.", "살바도르 달리"),
        ],
        "도전": [
            ("도전하지 않으면 얻을 수 없습니다.", "테디 루즈벨트"),
            ("안전지대를 벗어나야 성장할 수 있습니다.", "로빈 샤르마"),
            ("도전은 인생을 흥미롭게 하고 극복은 인생을 의미있게 합니다.", "조슈아 마린"),
            ("가장 큰 위험은 위험을 감수하지 않는 것입니다.", "마크 저커버그"),
            ("어려움은 기회로 가장한 축복입니다.", "헬렌 켈러"),
            ("도전 없이는 변화도 없습니다.", "짐 론"),
            ("두려움을 느낀다면 그것이 바로 해야 할 일입니다.", "랄프 왈도 에머슨"),
            ("도전은 숨겨진 능력을 발견하게 해줍니다.", "찰스 다윈"),
            ("편안함은 성장의 적입니다.", "네일 도날드 월시"),
            ("도전을 피하면 기회도 놓치게 됩니다.", "웨인 그레츠키"),
        ],
        "감사": [
            ("감사는 풍요로움을 가져다줍니다.", "오푸라 윈프리"),
            ("감사할 일을 찾으면 더 많은 감사할 일이 생깁니다.", "인에즈 알렌"),
            ("감사는 마음의 기억입니다.", "장 바티스트 마시유"),
            ("감사하는 마음은 행복의 열쇠입니다.", "멜로디 비티"),
            ("작은 것에 감사하면 큰 것도 받게 됩니다.", "아이크케"),
            ("감사는 현재를 충분하게 만듭니다.", "존 크라이슬랜드"),
            ("감사하는 마음은 모든 것을 변화시킵니다.", "로버트 에먼스"),
            ("감사는 삶을 풍요롭게 만드는 마법입니다.", "에이미 콜레트"),
            ("감사할 줄 아는 사람은 더 많은 복을 받습니다.", "키케로"),
            ("매일 감사 일기를 써보세요.", "오푸라 윈프리"),
        ],
        "평화": [
            ("평화는 내면에서 시작됩니다.", "달라이 라마"),
            ("마음이 평화로우면 모든 것이 평화롭습니다.", "중국 속담"),
            ("평화는 목적지가 아니라 여행하는 방식입니다.", "웨인 다이어"),
            ("내면의 평화가 외부의 평화를 만듭니다.", "달라이 라마"),
            ("평화는 분노의 부재가 아니라 정의의 존재입니다.", "마틴 루터 킹"),
            ("평화로운 마음은 가장 큰 축복입니다.", "틱낫한"),
            ("평화는 선택입니다.", "웨인 다이어"),
            ("평화는 힘이며 약함이 아닙니다.", "간디"),
            ("평화는 조화로운 관계에서 나옵니다.", "틱낫한"),
            ("평화는 용서에서 시작됩니다.", "넬슨 만델라"),
        ]
    }
    
    conn = None
    try:
        print("데이터베이스 연결 중...")
        conn = psycopg2.connect(**DATABASE_CONFIG)
        cursor = conn.cursor()
        
        total_added = 0
        
        for category, messages in quality_messages.items():
            print(f"\n'{category}' 카테고리 처리 중...")
            
            # 현재 개수 확인
            cursor.execute("""
                SELECT COUNT(*) FROM morning_prod.daily_messages 
                WHERE category = %s AND is_active = true
            """, (category,))
            current_count = cursor.fetchone()[0]
            
            # 목표: 각 카테고리당 최소 30개 고품질 메시지 추가
            for i, (text, author) in enumerate(messages):
                # 중복 체크
                cursor.execute("""
                    SELECT id FROM morning_prod.daily_messages 
                    WHERE text = %s AND category = %s
                """, (text, category))
                
                if cursor.fetchone():
                    print(f"  중복 건너뛰기: {text[:30]}...")
                    continue
                
                message_id = str(uuid.uuid4())
                cursor.execute("""
                    INSERT INTO morning_prod.daily_messages 
                    (id, text, author, category, is_active, reaction_count, view_count, created_at, updated_at)
                    VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)
                """, (
                    message_id, text, author, category, True,
                    0, 0, datetime.now(), datetime.now()
                ))
                
                total_added += 1
                print(f"  추가됨: {text[:50]}... - {author}")
        
        conn.commit()
        print(f"\n[완료] 총 {total_added}개의 고품질 메시지가 추가되었습니다!")
        
        cursor.close()
        conn.close()
        
    except Exception as e:
        print(f"오류 발생: {e}")
        if conn:
            conn.rollback()
            conn.close()

if __name__ == "__main__":
    bulk_add_messages()